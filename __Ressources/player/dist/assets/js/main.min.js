"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function e(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,i,a){return i&&e(t.prototype,i),a&&e(t,a),t}}(),Player=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"init",value:function(e,t,i){var a=this;this.$player=document.querySelector(e),this.$media=this.$player.querySelector(t),this.$media.addEventListener("loadedmetadata",function(){if("VIDEO"==a.$media.tagName){var e=function(){a.$media.setAttribute("height",a.$player.offsetHeight)};e(),window.addEventListener("resize",function(){e()})}}),this.$media.src=i}},{key:"controls",value:function(e){var t=this.$player.querySelector(e);this.$player.addEventListener("mousemove",function(){t.classList.add("visible"),setTimeout(function(){t.classList.remove("visible")},2e3)})}},{key:"playPause",value:function(e){var t=this,i=this.$player.querySelector(e),a=!1;i.classList.remove("playing");var n=function(){0==a?(i.classList.add("playing"),t.$media.play(),a=!0):(i.classList.remove("playing"),t.$media.pause(),a=!1)};i.addEventListener("mousedown",function(){n()}),document.addEventListener("keydown",function(e){32==e.keyCode&&n()})}},{key:"time",value:function(e,t,i){var a=this;this.$media.addEventListener("loadedmetadata",function(){var n=a.$player.querySelector(e),r=a.$player.querySelector(t),u=a.$player.querySelector(i),o=u.querySelector(".current"),l=(document.querySelector(".current-thumbnail"),!1),s=!1;a.convertHHMMSS=function(e){var t=Math.floor(e/3600),i=Math.floor(e%3600/60),n=Math.floor(e%3600%60),r=function(e){return e<10?"0"+e:e};return a.$media.duration<3600?r(i)+":"+r(n):r(t)+":"+r(i)+":"+r(n)};var d=function(e,t){n.innerHTML=a.convertHHMMSS(e),o.style.width=t+"%",a.$media.currentTime+1>=a.$media.duration&&0==s&&(s=!0,playlist.next())};d(a.$media.currentTime,0),a.$media.addEventListener("timeupdate",function(){d(a.$media.currentTime,a.$media.currentTime/a.$media.duration*100)}),r.innerHTML=a.convertHHMMSS(a.$media.duration),a.$player.addEventListener("mousemove",function(){var e=function(){var e=(event.clientX-u.offsetLeft-a.$player.offsetLeft)/u.offsetWidth*100,t=e/100*a.$media.duration;a.$media.currentTime=t,d(t,e)};l&&e(),u.addEventListener("mousedown",function(){l=!0,e()}),document.addEventListener("mouseup",function(){l=!1})}),document.addEventListener("keydown",function(e){switch(e.keyCode){case 37:a.$media.currentTime-=5;break;case 39:a.$media.currentTime+=5;break;case 49:a.$media.currentTime=.1*a.$media.duration;break;case 50:a.$media.currentTime=.2*a.$media.duration;break;case 51:a.$media.currentTime=.3*a.$media.duration;break;case 52:a.$media.currentTime=.4*a.$media.duration;break;case 53:a.$media.currentTime=.5*a.$media.duration;break;case 54:a.$media.currentTime=.6*a.$media.duration;break;case 55:a.$media.currentTime=.7*a.$media.duration;break;case 56:a.$media.currentTime=.8*a.$media.duration;break;case 57:a.$media.currentTime=.9*a.$media.duration;break;case 48:a.$media.currentTime=a.$media.duration}d(a.$media.currentTime)})})}},{key:"volume",value:function(e,t){var i=this,a=this.$player.querySelector(e),n=this.$player.querySelector(t),r=n.querySelector(".current");this.volume=.5;var u=null,o=!1,l=!1,s=function(e){i.volume=e,i.volume<0&&(i.volume=0),i.volume>=.75?a.innerHTML='<i class="fa fa-volume-up" aria-hidden="true"></i>':0==i.volume?a.innerHTML='<i class="fa fa-volume-off" aria-hidden="true"></i>':a.innerHTML='<i class="fa fa-volume-down" aria-hidden="true"></i>',r.style.width=e*n.offsetWidth+"px",i.$media.volume=i.volume};s(.5);var d=function(){o?(o=!1,s(u)):(u=i.volume,o=!0,s(0))};a.addEventListener("mousedown",function(){d()}),n.addEventListener("mousemove",function(){if(l){var e=event.clientX-n.offsetLeft-i.$player.offsetLeft;e>n.offsetWidth&&(e=n.offsetWidth),s(e/n.offsetWidth)}n.addEventListener("mousedown",function(){l=!0}),n.addEventListener("mouseup",function(){l=!1}),n.addEventListener("mouseout",function(){l=!1})}),document.addEventListener("keydown",function(e){switch(e.keyCode){case 38:i.$media.volume<=.9?i.$media.volume+=.1:i.$media.volume=1,s(i.$media.volume);break;case 40:i.$media.volume>=.1?i.$media.volume-=.1:i.$media.volume=0,s(i.$media.volume);break;case 77:d()}})}},{key:"fullscreen",value:function(){var e=this,t=function(){-1!=navigator.userAgent.indexOf("Chrome")?e.$media.webkitRequestFullscreen():-1!=navigator.userAgent.indexOf("Firefox")?e.$media.mozRequestFullscreen():-1!=navigator.userAgent.indexOf("MSIE")||1==!!document.documentMode?e.$media.msRequestFullscreen():alert("Plein écran non supporté...")};this.$player.querySelector(".fullscreen").addEventListener("mousedown",function(){t()}),document.addEventListener("keydown",function(e){70==e.keyCode&&t()})}}]),e}(),Playlist=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"init",value:function(e){this.list=[],this.$temp=document.querySelector(".temp"),this.$mediaName=document.querySelector(".media-name");var t=document.querySelector(e);t.addEventListener("change",function(){playlist.add(t)})}},{key:"add",value:function(e){var t=this,i=(document.querySelector("video"),e.files[0]),a=new FileReader;a.addEventListener("load",function(){t.$mediaName.innerHTML;var i=function(e){return e=e.split("\\")[2].split(".")[0],e=e.replace("-"," ")}(e.value);t.$temp.src=a.result,t.list.push([a.result,i]),playlist.updateList(t.list)},!1),i&&a.readAsDataURL(i)}},{key:"updateList",value:function(e){var t=document.querySelector(".tracks");t.innerHTML="";var i=!0,a=!1,n=void 0;try{for(var r,u=e[Symbol.iterator]();!(i=(r=u.next()).done);i=!0){var o=r.value,l=(o[0],o[1]),s=document.createElement("div");s.classList.add("track"),t.appendChild(s);var d=document.createElement("div");d.classList.add("track-name"),d.innerHTML=l,s.appendChild(d);var c=document.createElement("button");c.classList.add("skip"),c.innerHTML='<i class="fa fa-play" aria-hidden="true"></i>',s.appendChild(c),playlist.skip()}}catch(e){a=!0,n=e}finally{try{!i&&u.return&&u.return()}finally{if(a)throw n}}}},{key:"next",value:function(){if(this.list[0]){var e=this.list[0][0],t=this.list[0][1];this.list.splice(0,1),playlist.updateList(this.list),this.$mediaName.innerHTML=t,player.init(".player","video",e),player.playPause(".play-pause")}}},{key:"skip",value:function(){for(var e=this,t=document.querySelectorAll(".skip"),i=0;i<t.length;i++)!function(i){t[i].addEventListener("mousedown",function(){player.init(".player",".media",e.list[i][0]),e.list.splice(i,1),updateList(e.list)})}(i)}}]),e}(),player=new Player,playlist=new Playlist,trackURL="assets/media/cabiac.mp4";player.init(".player",".media",trackURL),player.controls(".controls"),player.playPause(".play-pause"),player.time(".current-time",".total-time",".time-bar"),player.volume(".volume-icon",".volume-bar"),player.fullscreen(".fullscreen"),playlist.init(".import");
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIlBsYXllci5qcyIsIlBsYXlsaXN0LmpzIiwibWFpbi5qcyJdLCJuYW1lcyI6WyJQbGF5ZXIiLCIkX3BsYXllciIsIiRfbWVkaWEiLCJ0cmFja1VSTCIsIl90aGlzIiwidGhpcyIsIiRwbGF5ZXIiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCIkbWVkaWEiLCJhZGRFdmVudExpc3RlbmVyIiwidGFnTmFtZSIsInJlc2l6ZSIsInNldEF0dHJpYnV0ZSIsIm9mZnNldEhlaWdodCIsIndpbmRvdyIsInNyYyIsIiRfY29udHJvbHMiLCIkY29udHJvbHMiLCJjbGFzc0xpc3QiLCJhZGQiLCJzZXRUaW1lb3V0IiwicmVtb3ZlIiwiJF9wbGF5UGF1c2UiLCJfdGhpczIiLCIkcGxheVBhdXNlIiwiaXNQbGF5aW5nIiwidXBkYXRlUGxheVBhdXNlIiwicGxheSIsInBhdXNlIiwiZXZlbnQiLCJrZXlDb2RlIiwiJF9jdXJyZW50VGltZSIsIiRfdG90YWxUaW1lIiwiJF90aW1lQmFyIiwiX3RoaXMzIiwiJGN1cnJlbnRUaW1lIiwiJHRvdGFsVGltZSIsIiR0aW1lQmFyIiwiJGN1cnJlbnRUaW1lQmFyIiwiZ3JhYmJpbmciLCJuZXh0ZWQiLCJjb252ZXJ0SEhNTVNTIiwidGltZSIsImhvdXJzIiwiTWF0aCIsImZsb29yIiwibWludXRlcyIsInNlY29uZHMiLCJsZWFkaW5nWmVybyIsIm51bWJlciIsImR1cmF0aW9uIiwidXBkYXRlQ3VycmVudFRpbWUiLCJtb3VzZVBlcmNlbnQiLCJpbm5lckhUTUwiLCJzdHlsZSIsIndpZHRoIiwiY3VycmVudFRpbWUiLCJwbGF5bGlzdCIsIm5leHQiLCJncmFiIiwiY2xpZW50WCIsIm9mZnNldExlZnQiLCJvZmZzZXRXaWR0aCIsIiRfdm9sdW1lSWNvbiIsIiRfdm9sdW1lQmFyIiwiX3RoaXM0IiwiJHZvbHVtZUljb24iLCIkdm9sdW1lQmFyIiwiJGN1cnJlbnRWb2x1bWVCYXIiLCJ2b2x1bWUiLCJtZW1Wb2x1bWUiLCJpc011dGVkIiwidXBkYXRlVm9sdW1lIiwibXV0ZSIsIm1vdXNlUG9zWCIsIl90aGlzNSIsImZ1bGxzY3JlZW4iLCJuYXZpZ2F0b3IiLCJ1c2VyQWdlbnQiLCJpbmRleE9mIiwid2Via2l0UmVxdWVzdEZ1bGxzY3JlZW4iLCJtb3pSZXF1ZXN0RnVsbHNjcmVlbiIsImRvY3VtZW50TW9kZSIsIm1zUmVxdWVzdEZ1bGxzY3JlZW4iLCJhbGVydCIsIlBsYXlsaXN0IiwiJF9pbXBvcnQiLCJsaXN0IiwiJHRlbXAiLCIkbWVkaWFOYW1lIiwiJGltcG9ydCIsIl90aGlzNiIsIiRmaWxlIiwiZmlsZXMiLCJyZWFkZXIiLCJGaWxlUmVhZGVyIiwidHJhY2tOYW1lIiwidXJsIiwic3BsaXQiLCJyZXBsYWNlIiwiY2xlYW5OYW1lIiwidmFsdWUiLCJyZXN1bHQiLCJwdXNoIiwidXBkYXRlTGlzdCIsInJlYWRBc0RhdGFVUkwiLCJ0cmFja3MiLCIkdHJhY2tzIiwiX2l0ZXJhdG9yTm9ybWFsQ29tcGxldGlvbiIsIl9kaWRJdGVyYXRvckVycm9yIiwiX2l0ZXJhdG9yRXJyb3IiLCJ1bmRlZmluZWQiLCJfc3RlcCIsIl9pdGVyYXRvciIsIlN5bWJvbCIsIml0ZXJhdG9yIiwiZG9uZSIsInRyYWNrIiwiJHRyYWNrIiwiY3JlYXRlRWxlbWVudCIsImFwcGVuZENoaWxkIiwiJHRyYWNrTmFtZSIsIiRza2lwIiwic2tpcCIsImVyciIsInJldHVybiIsInNwbGljZSIsInBsYXllciIsImluaXQiLCJwbGF5UGF1c2UiLCJfdGhpczciLCIkc2tpcHMiLCJxdWVyeVNlbGVjdG9yQWxsIiwibGVuZ3RoIiwiX2xvb3AiLCJjb250cm9scyJdLCJtYXBwaW5ncyI6IjZYQUFBQSx5R0FFQUMsRUFBQUMsRUFBQUMsR0FBQSxJQUFBQyxFQUFBQyxLQUNBQSxLQUFBQyxRQUFBQyxTQUFBQyxjQUFBUCxHQUNBSSxLQUFBSSxPQUFBSixLQUFBQyxRQUFBRSxjQUFBTixHQUVBRyxLQUFBSSxPQUFBQyxpQkFBQSxpQkFBQSxXQUNBLEdBQUEsU0FBQU4sRUFB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QSxTQUdBQSxHQUNBUSxFQUFBUixHQUFBbEgsaUJBQUEsWUFBQSxXQUNBc0gsT0FBQUMsS0FBQSxVQUFBLFNBQUFFLEVBQUEzQyxLQUFBb0MsR0FBQSxJQUNBTyxFQUFBM0MsS0FBQXVDLE9BQUFILEVBQUEsR0FDQW5CLFdBQUEwQixFQUFBM0MsUUFKQStDLENBQUFYLFlDaEZBSSxPQUFBLElBQUFoSSxPQUNBMEQsU0FBQSxJQUFBNEIsU0FFQW5GLFNBQUEsMEJBRUE2SCxPQUFBQyxLQUFBLFVBQUEsU0FBQTlILFVBR0E2SCxPQUFBUSxTQUFBLGFBQ0FSLE9BQUFFLFVBQUEsZUFDQUYsT0FBQXJGLEtBQUEsZ0JBQUEsY0FBQSxhQUNBcUYsT0FBQTFELE9BQUEsZUFBQSxlQUNBMEQsT0FBQW5ELFdBQUEsZUFHQW5CLFNBQUF1RSxLQUFBIiwiZmlsZSI6Im1haW4ubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiY2xhc3MgUGxheWVyIHtcblx0XG5cdGluaXQoJF9wbGF5ZXIsICRfbWVkaWEsIHRyYWNrVVJMKSB7XG5cdFx0dGhpcy4kcGxheWVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcigkX3BsYXllcilcblx0XHR0aGlzLiRtZWRpYSA9IHRoaXMuJHBsYXllci5xdWVyeVNlbGVjdG9yKCRfbWVkaWEpXG5cblx0XHR0aGlzLiRtZWRpYS5hZGRFdmVudExpc3RlbmVyKCdsb2FkZWRtZXRhZGF0YScsICgpID0+IHtcblx0XHRcdGlmICh0aGlzLiRtZWRpYS50YWdOYW1lID09ICdWSURFTycpIHtcblx0XHRcdFx0Y29uc3QgcmVzaXplID0gKCkgPT4ge1xuXHRcdFx0XHRcdHRoaXMuJG1lZGlhLnNldEF0dHJpYnV0ZSgnaGVpZ2h0JywgdGhpcy4kcGxheWVyLm9mZnNldEhlaWdodClcblx0XHRcdFx0fVxuXHRcdFx0XHRyZXNpemUoKVxuXG5cdFx0XHRcdHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdyZXNpemUnLCAoKSA9PiB7XG5cdFx0XHRcdFx0cmVzaXplKClcblx0XHRcdFx0fSlcblx0XHRcdH1cblx0XHR9KVxuXG5cdFx0dGhpcy4kbWVkaWEuc3JjID0gdHJhY2tVUkxcblx0fVxuXG5cdGNvbnRyb2xzKCRfY29udHJvbHMpIHtcblx0XHRjb25zdCAkY29udHJvbHMgPSB0aGlzLiRwbGF5ZXIucXVlcnlTZWxlY3RvcigkX2NvbnRyb2xzKVxuXG5cdFx0dGhpcy4kcGxheWVyLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlbW92ZScsICgpID0+IHtcblx0XHRcdFxuXHRcdFx0JGNvbnRyb2xzLmNsYXNzTGlzdC5hZGQoJ3Zpc2libGUnKVxuXHRcdFx0XG5cdFx0XHRzZXRUaW1lb3V0KCgpID0+IHtcblx0XHRcdFx0JGNvbnRyb2xzLmNsYXNzTGlzdC5yZW1vdmUoJ3Zpc2libGUnKVxuXHRcdFx0fSwyMDAwKVxuXHRcdH0pXG5cdH1cblxuXHRwbGF5UGF1c2UoJF9wbGF5UGF1c2UpIHtcblx0XHRjb25zdCAkcGxheVBhdXNlID0gdGhpcy4kcGxheWVyLnF1ZXJ5U2VsZWN0b3IoJF9wbGF5UGF1c2UpXG5cblx0XHRsZXQgaXNQbGF5aW5nID0gZmFsc2Vcblx0XHQkcGxheVBhdXNlLmNsYXNzTGlzdC5yZW1vdmUoJ3BsYXlpbmcnKVxuXG5cdFx0Y29uc3QgdXBkYXRlUGxheVBhdXNlID0gKCkgPT4ge1xuXHRcdFx0aWYgKGlzUGxheWluZyA9PSBmYWxzZSkge1xuXHRcdFx0XHQkcGxheVBhdXNlLmNsYXNzTGlzdC5hZGQoJ3BsYXlpbmcnKVxuXHRcdFx0XHR0aGlzLiRtZWRpYS5wbGF5KClcblx0XHRcdFx0aXNQbGF5aW5nID0gdHJ1ZVxuXHRcdFx0fVxuXHRcdFx0ZWxzZSB7XG5cdFx0XHRcdCRwbGF5UGF1c2UuY2xhc3NMaXN0LnJlbW92ZSgncGxheWluZycpXG5cdFx0XHRcdHRoaXMuJG1lZGlhLnBhdXNlKClcblx0XHRcdFx0aXNQbGF5aW5nID0gZmFsc2Vcblx0XHRcdH1cblx0XHR9XG5cdFx0XG5cdFx0JHBsYXlQYXVzZS5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWRvd24nLCAoKSA9PiB7XG5cdFx0XHR1cGRhdGVQbGF5UGF1c2UoKVxuXHRcdH0pXG5cblx0XHRkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgKGV2ZW50KSA9PiB7XG5cdFx0XHRpZiAoZXZlbnQua2V5Q29kZSA9PSAzMikge1xuXHRcdFx0XHR1cGRhdGVQbGF5UGF1c2UoKVxuXHRcdFx0fVxuXHRcdH0pXG5cdH1cblxuXHR0aW1lKCRfY3VycmVudFRpbWUsICRfdG90YWxUaW1lLCAkX3RpbWVCYXIpIHtcblx0XHR0aGlzLiRtZWRpYS5hZGRFdmVudExpc3RlbmVyKCdsb2FkZWRtZXRhZGF0YScsICgpID0+IHtcblx0XHRcdGNvbnN0ICRjdXJyZW50VGltZSA9IHRoaXMuJHBsYXllci5xdWVyeVNlbGVjdG9yKCRfY3VycmVudFRpbWUpXG5cdFx0XHRjb25zdCAkdG90YWxUaW1lID0gdGhpcy4kcGxheWVyLnF1ZXJ5U2VsZWN0b3IoJF90b3RhbFRpbWUpXG5cdFx0XHRjb25zdCAkdGltZUJhciA9IHRoaXMuJHBsYXllci5xdWVyeVNlbGVjdG9yKCRfdGltZUJhcilcblx0XHRcdGNvbnN0ICRjdXJyZW50VGltZUJhciA9ICR0aW1lQmFyLnF1ZXJ5U2VsZWN0b3IoJy5jdXJyZW50Jylcblx0XHRcdGNvbnN0ICRjdXJyZW50VGh1bWJuYWlsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmN1cnJlbnQtdGh1bWJuYWlsJylcblxuXHRcdFx0bGV0IGdyYWJiaW5nID0gZmFsc2Vcblx0XHRcdGxldCBuZXh0ZWQgPSBmYWxzZVxuXG5cdFx0XHR0aGlzLmNvbnZlcnRISE1NU1MgPSAodGltZSkgPT4ge1xuXHRcdFx0XHRsZXQgaG91cnMgPSBNYXRoLmZsb29yKHRpbWUgLyAzNjAwKVxuXHRcdFx0XHRsZXQgbWludXRlcyA9IE1hdGguZmxvb3IodGltZSAlIDM2MDAgLyA2MClcblx0XHRcdFx0bGV0IHNlY29uZHMgPSBNYXRoLmZsb29yKHRpbWUgJSAzNjAwICUgNjApXG5cblx0XHRcdFx0Y29uc3QgbGVhZGluZ1plcm8gPSAobnVtYmVyKSA9PiB7XG5cdFx0XHRcdFx0aWYgKG51bWJlciA8IDEwKSB7XG5cdFx0XHRcdFx0XHRyZXR1cm4gJzAnICsgbnVtYmVyXG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdGVsc2Uge1xuXHRcdFx0XHRcdFx0cmV0dXJuIG51bWJlclxuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXG5cdFx0XHRcdGlmICh0aGlzLiRtZWRpYS5kdXJhdGlvbiA8IDM2MDApIHtcblx0XHRcdFx0XHRyZXR1cm4gYCR7bGVhZGluZ1plcm8obWludXRlcyl9OiR7bGVhZGluZ1plcm8oc2Vjb25kcyl9YFxuXHRcdFx0XHR9XG5cdFx0XHRcdGVsc2Uge1xuXHRcdFx0XHRcdHJldHVybiBgJHtsZWFkaW5nWmVybyhob3Vycyl9OiR7bGVhZGluZ1plcm8obWludXRlcyl9OiR7bGVhZGluZ1plcm8oc2Vjb25kcyl9YFxuXHRcdFx0XHR9XG5cdFx0XHR9XG5cblx0XHRcdGNvbnN0IHVwZGF0ZUN1cnJlbnRUaW1lID0gKHRpbWUsIG1vdXNlUGVyY2VudCkgPT4ge1xuXHRcdFx0XHQkY3VycmVudFRpbWUuaW5uZXJIVE1MID0gdGhpcy5jb252ZXJ0SEhNTVNTKHRpbWUpXG5cdFx0XHRcdCRjdXJyZW50VGltZUJhci5zdHlsZS53aWR0aCA9IGAke21vdXNlUGVyY2VudH0lYFxuXG5cdFx0XHRcdGlmICh0aGlzLiRtZWRpYS5jdXJyZW50VGltZSArIDEgPj0gdGhpcy4kbWVkaWEuZHVyYXRpb24pIHtcblx0XHRcdFx0XHRpZiAobmV4dGVkID09IGZhbHNlKSB7XG5cdFx0XHRcdFx0XHRuZXh0ZWQgPSB0cnVlXG5cdFx0XHRcdFx0XHRwbGF5bGlzdC5uZXh0KClcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cdFx0XG5cdFx0XHR9XG5cdFx0XHR1cGRhdGVDdXJyZW50VGltZSh0aGlzLiRtZWRpYS5jdXJyZW50VGltZSwgMClcblx0XHRcdHRoaXMuJG1lZGlhLmFkZEV2ZW50TGlzdGVuZXIoJ3RpbWV1cGRhdGUnLCAoKSA9PiB7XG5cdFx0XHRcdHVwZGF0ZUN1cnJlbnRUaW1lKHRoaXMuJG1lZGlhLmN1cnJlbnRUaW1lLCB0aGlzLiRtZWRpYS5jdXJyZW50VGltZSAvIHRoaXMuJG1lZGlhLmR1cmF0aW9uICogMTAwKVxuXHRcdFx0fSlcblxuXHRcdFx0JHRvdGFsVGltZS5pbm5lckhUTUwgPSB0aGlzLmNvbnZlcnRISE1NU1ModGhpcy4kbWVkaWEuZHVyYXRpb24pXG5cblx0XHRcdHRoaXMuJHBsYXllci5hZGRFdmVudExpc3RlbmVyKCdtb3VzZW1vdmUnLCAoKSA9PiB7XG5cdFx0XHRcdGNvbnN0IGdyYWIgPSAoKSA9PiB7XG5cdFx0XHRcdFx0Y29uc3QgbW91c2VQZXJjZW50ID0gKChldmVudC5jbGllbnRYIC0gJHRpbWVCYXIub2Zmc2V0TGVmdCAtIHRoaXMuJHBsYXllci5vZmZzZXRMZWZ0KSAvICR0aW1lQmFyLm9mZnNldFdpZHRoICogMTAwKVxuXHRcdFx0XHRcdFxuXHRcdFx0XHRcdGNvbnN0IHRpbWUgPSBtb3VzZVBlcmNlbnQgLyAxMDAgKiB0aGlzLiRtZWRpYS5kdXJhdGlvblxuXG5cdFx0XHRcdFx0dGhpcy4kbWVkaWEuY3VycmVudFRpbWUgPSB0aW1lXG5cdFx0XHRcdFx0dXBkYXRlQ3VycmVudFRpbWUodGltZSwgbW91c2VQZXJjZW50KVxuXHRcdFx0XHR9XG5cblx0XHRcdFx0aWYgKGdyYWJiaW5nKSB7XG5cdFx0XHRcdFx0Z3JhYigpXG5cdFx0XHRcdH1cblx0XHRcdFx0XG5cdFx0XHRcdCR0aW1lQmFyLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlZG93bicsICgpID0+IHtcblx0XHRcdFx0XHRncmFiYmluZyA9IHRydWVcblx0XHRcdFx0XHRncmFiKClcblx0XHRcdFx0fSlcblxuXHRcdFx0XHRkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZXVwJywgKCkgPT4ge1xuXHRcdFx0XHRcdGdyYWJiaW5nID0gZmFsc2Vcblx0XHRcdFx0fSlcblx0XHRcdH0pXG5cblx0XHRcdGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCAoZXZlbnQpID0+IHtcblx0XHRcdFx0c3dpdGNoIChldmVudC5rZXlDb2RlKSB7XG5cdFx0XHRcdGNhc2UgMzc6IC8vIGFycm93IGxlZnRcblx0XHRcdFx0XHR0aGlzLiRtZWRpYS5jdXJyZW50VGltZSAtPSA1XG5cdFx0XHRcdFx0YnJlYWtcblx0XHRcdFx0Y2FzZSAzOTogLy8gYXJyb3cgcmlnaHRcblx0XHRcdFx0XHR0aGlzLiRtZWRpYS5jdXJyZW50VGltZSArPSA1XG5cdFx0XHRcdFx0YnJlYWtcblx0XHRcdFx0Y2FzZSA0OTogLy8gMVxuXHRcdFx0XHRcdHRoaXMuJG1lZGlhLmN1cnJlbnRUaW1lID0gdGhpcy4kbWVkaWEuZHVyYXRpb24gKiAuMVxuXHRcdFx0XHRcdGJyZWFrXG5cdFx0XHRcdGNhc2UgNTA6IC8vIDJcblx0XHRcdFx0XHR0aGlzLiRtZWRpYS5jdXJyZW50VGltZSA9IHRoaXMuJG1lZGlhLmR1cmF0aW9uICogLjJcblx0XHRcdFx0XHRicmVha1xuXHRcdFx0XHRjYXNlIDUxOiAvLyAzXG5cdFx0XHRcdFx0dGhpcy4kbWVkaWEuY3VycmVudFRpbWUgPSB0aGlzLiRtZWRpYS5kdXJhdGlvbiAqIC4zXG5cdFx0XHRcdFx0YnJlYWtcdFxuXHRcdFx0XHRjYXNlIDUyOiAvLyA0XG5cdFx0XHRcdFx0dGhpcy4kbWVkaWEuY3VycmVudFRpbWUgPSB0aGlzLiRtZWRpYS5kdXJhdGlvbiAqIC40XG5cdFx0XHRcdFx0YnJlYWtcdFxuXHRcdFx0XHRjYXNlIDUzOiAvLyA1XG5cdFx0XHRcdFx0dGhpcy4kbWVkaWEuY3VycmVudFRpbWUgPSB0aGlzLiRtZWRpYS5kdXJhdGlvbiAqIC41XG5cdFx0XHRcdFx0YnJlYWtcblx0XHRcdFx0Y2FzZSA1NDogLy8gNlxuXHRcdFx0XHRcdHRoaXMuJG1lZGlhLmN1cnJlbnRUaW1lID0gdGhpcy4kbWVkaWEuZHVyYXRpb24gKiAuNlxuXHRcdFx0XHRcdGJyZWFrXG5cdFx0XHRcdGNhc2UgNTU6IC8vIDdcblx0XHRcdFx0XHR0aGlzLiRtZWRpYS5jdXJyZW50VGltZSA9IHRoaXMuJG1lZGlhLmR1cmF0aW9uICogLjdcblx0XHRcdFx0XHRicmVha1x0XG5cdFx0XHRcdGNhc2UgNTY6IC8vIDhcblx0XHRcdFx0XHR0aGlzLiRtZWRpYS5jdXJyZW50VGltZSA9IHRoaXMuJG1lZGlhLmR1cmF0aW9uICogLjhcblx0XHRcdFx0XHRicmVha1x0XG5cdFx0XHRcdGNhc2UgNTc6IC8vIDlcblx0XHRcdFx0XHR0aGlzLiRtZWRpYS5jdXJyZW50VGltZSA9IHRoaXMuJG1lZGlhLmR1cmF0aW9uICogLjlcblx0XHRcdFx0XHRicmVha1x0XG5cdFx0XHRcdGNhc2UgNDg6IC8vIDBcblx0XHRcdFx0XHR0aGlzLiRtZWRpYS5jdXJyZW50VGltZSA9IHRoaXMuJG1lZGlhLmR1cmF0aW9uXG5cdFx0XHRcdFx0YnJlYWtcdFxuXHRcdFx0XHR9XG5cdFx0XHRcdHVwZGF0ZUN1cnJlbnRUaW1lKHRoaXMuJG1lZGlhLmN1cnJlbnRUaW1lKVxuXHRcdFx0fSlcblx0XHR9KVxuXHR9XG5cblx0dm9sdW1lKCRfdm9sdW1lSWNvbiwgJF92b2x1bWVCYXIpIHtcblx0XHRjb25zdCAkdm9sdW1lSWNvbiA9IHRoaXMuJHBsYXllci5xdWVyeVNlbGVjdG9yKCRfdm9sdW1lSWNvbilcblx0XHRjb25zdCAkdm9sdW1lQmFyID0gdGhpcy4kcGxheWVyLnF1ZXJ5U2VsZWN0b3IoJF92b2x1bWVCYXIpXG5cdFx0Y29uc3QgJGN1cnJlbnRWb2x1bWVCYXIgPSAkdm9sdW1lQmFyLnF1ZXJ5U2VsZWN0b3IoJy5jdXJyZW50JylcblxuXHRcdHRoaXMudm9sdW1lID0gLjVcblx0XHRsZXQgbWVtVm9sdW1lID0gbnVsbFxuXHRcdGxldCBpc011dGVkID0gZmFsc2Vcblx0XHRsZXQgZ3JhYmJpbmcgPSBmYWxzZVxuXG5cdFx0Y29uc3QgdXBkYXRlVm9sdW1lID0gKHZvbHVtZSkgPT4ge1xuXHRcdFx0dGhpcy52b2x1bWUgPSB2b2x1bWVcblxuXHRcdFx0aWYgKHRoaXMudm9sdW1lIDwgMCkge1xuXHRcdFx0XHR0aGlzLnZvbHVtZSA9IDBcblx0XHRcdH1cblxuXHRcdFx0aWYgKHRoaXMudm9sdW1lID49IC43NSkge1xuXHRcdFx0XHQkdm9sdW1lSWNvbi5pbm5lckhUTUwgPSAnPGkgY2xhc3M9XCJmYSBmYS12b2x1bWUtdXBcIiBhcmlhLWhpZGRlbj1cInRydWVcIj48L2k+J1xuXHRcdFx0fVxuXHRcdFx0ZWxzZSBpZiAodGhpcy52b2x1bWUgPT0gMCkge1xuXHRcdFx0XHQkdm9sdW1lSWNvbi5pbm5lckhUTUwgPSAnPGkgY2xhc3M9XCJmYSBmYS12b2x1bWUtb2ZmXCIgYXJpYS1oaWRkZW49XCJ0cnVlXCI+PC9pPidcblx0XHRcdH1cblx0XHRcdGVsc2Uge1xuXHRcdFx0XHQkdm9sdW1lSWNvbi5pbm5lckhUTUwgPSAnPGkgY2xhc3M9XCJmYSBmYS12b2x1bWUtZG93blwiIGFyaWEtaGlkZGVuPVwidHJ1ZVwiPjwvaT4nXG5cdFx0XHR9XG5cblx0XHRcdCRjdXJyZW50Vm9sdW1lQmFyLnN0eWxlLndpZHRoID0gYCR7dm9sdW1lICogJHZvbHVtZUJhci5vZmZzZXRXaWR0aH1weGBcblx0XHRcdFxuXHRcdFx0dGhpcy4kbWVkaWEudm9sdW1lID0gdGhpcy52b2x1bWVcblx0XHR9XG5cdFx0dXBkYXRlVm9sdW1lKC41KVxuXG5cdFx0Y29uc3QgbXV0ZSA9ICgpID0+IHtcblx0XHRcdGlmIChpc011dGVkKSB7XG5cdFx0XHRcdGlzTXV0ZWQgPSBmYWxzZVxuXHRcdFx0XHR1cGRhdGVWb2x1bWUobWVtVm9sdW1lKVxuXHRcdFx0fVxuXHRcdFx0ZWxzZSB7XG5cdFx0XHRcdG1lbVZvbHVtZSA9IHRoaXMudm9sdW1lXG5cdFx0XHRcdGlzTXV0ZWQgPSB0cnVlXG5cdFx0XHRcdHVwZGF0ZVZvbHVtZSgwKVxuXHRcdFx0fVxuXHRcdH1cblxuXHRcdCR2b2x1bWVJY29uLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlZG93bicsICgpID0+IHtcblx0XHRcdG11dGUoKVxuXHRcdH0pXG5cblx0XHQkdm9sdW1lQmFyLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlbW92ZScsICgpID0+IHtcblx0XHRcdGlmIChncmFiYmluZykge1xuXHRcdFx0XHRsZXQgbW91c2VQb3NYID0gKGV2ZW50LmNsaWVudFggLSAkdm9sdW1lQmFyLm9mZnNldExlZnQgLSB0aGlzLiRwbGF5ZXIub2Zmc2V0TGVmdClcblx0XHRcdFx0aWYgKG1vdXNlUG9zWCA+ICR2b2x1bWVCYXIub2Zmc2V0V2lkdGgpIHtcblx0XHRcdFx0XHRtb3VzZVBvc1ggPSAkdm9sdW1lQmFyLm9mZnNldFdpZHRoXG5cdFx0XHRcdH1cblx0XHRcdFx0dXBkYXRlVm9sdW1lKG1vdXNlUG9zWCAvICR2b2x1bWVCYXIub2Zmc2V0V2lkdGgpXG5cdFx0XHR9XG5cdFx0XHRcblx0XHRcdCR2b2x1bWVCYXIuYWRkRXZlbnRMaXN0ZW5lcignbW91c2Vkb3duJywgKCkgPT4ge1xuXHRcdFx0XHRncmFiYmluZyA9IHRydWVcblx0XHRcdH0pXG5cblx0XHRcdCR2b2x1bWVCYXIuYWRkRXZlbnRMaXN0ZW5lcignbW91c2V1cCcsICgpID0+IHtcblx0XHRcdFx0Z3JhYmJpbmcgPSBmYWxzZVxuXHRcdFx0fSlcblxuXHRcdFx0JHZvbHVtZUJhci5hZGRFdmVudExpc3RlbmVyKCdtb3VzZW91dCcsICgpID0+IHtcblx0XHRcdFx0Z3JhYmJpbmcgPSBmYWxzZVxuXHRcdFx0fSlcblx0XHR9KVxuXG5cdFx0ZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIChldmVudCkgPT4ge1xuXHRcdFx0c3dpdGNoIChldmVudC5rZXlDb2RlKSB7XG5cdFx0XHRjYXNlIDM4OlxuXHRcdFx0XHRpZiAodGhpcy4kbWVkaWEudm9sdW1lIDw9IC45KSB7XG5cdFx0XHRcdFx0dGhpcy4kbWVkaWEudm9sdW1lICs9IC4xXG5cdFx0XHRcdH1cblx0XHRcdFx0ZWxzZSB7XG5cdFx0XHRcdFx0dGhpcy4kbWVkaWEudm9sdW1lID0gMVxuXHRcdFx0XHR9XG5cdFx0XHRcdHVwZGF0ZVZvbHVtZSh0aGlzLiRtZWRpYS52b2x1bWUpXHRcblx0XHRcdFx0YnJlYWtcblx0XHRcdGNhc2UgNDA6XG5cdFx0XHRcdGlmICh0aGlzLiRtZWRpYS52b2x1bWUgPj0gLjEpIHtcblx0XHRcdFx0XHR0aGlzLiRtZWRpYS52b2x1bWUgLT0gLjFcblx0XHRcdFx0fVxuXHRcdFx0XHRlbHNlIHtcblx0XHRcdFx0XHR0aGlzLiRtZWRpYS52b2x1bWUgPSAwXG5cdFx0XHRcdH1cblx0XHRcdFx0dXBkYXRlVm9sdW1lKHRoaXMuJG1lZGlhLnZvbHVtZSlcblx0XHRcdFx0YnJlYWtcblx0XHRcdGNhc2UgNzc6XG5cdFx0XHRcdG11dGUoKVxuXHRcdFx0XHRicmVha1xuXHRcdFx0fVx0XG5cdFx0fSlcblx0fVxuXG5cdGZ1bGxzY3JlZW4oKSB7XG5cdFx0Y29uc3QgJGZ1bGxzY3JlZW4gPSB0aGlzLiRwbGF5ZXIucXVlcnlTZWxlY3RvcignLmZ1bGxzY3JlZW4nKVxuXG5cdFx0Y29uc3QgZnVsbHNjcmVlbiA9ICgpID0+IHtcblx0XHRcdGlmIChuYXZpZ2F0b3IudXNlckFnZW50LmluZGV4T2YoJ0Nocm9tZScpICE9IC0xKSB7XG5cdFx0XHRcdHRoaXMuJG1lZGlhLndlYmtpdFJlcXVlc3RGdWxsc2NyZWVuKClcblx0XHRcdH1cblx0XHRcdGVsc2UgaWYgKG5hdmlnYXRvci51c2VyQWdlbnQuaW5kZXhPZignRmlyZWZveCcpICE9IC0xKSB7XG5cdFx0XHRcdHRoaXMuJG1lZGlhLm1velJlcXVlc3RGdWxsc2NyZWVuKClcblx0XHRcdH1cblx0XHRcdGVsc2UgaWYgKChuYXZpZ2F0b3IudXNlckFnZW50LmluZGV4T2YoJ01TSUUnKSAhPSAtMSApIHx8ICghIWRvY3VtZW50LmRvY3VtZW50TW9kZSA9PSB0cnVlICkpIHtcblx0XHRcdFx0dGhpcy4kbWVkaWEubXNSZXF1ZXN0RnVsbHNjcmVlbigpXG5cdFx0XHR9XG5cdFx0XHRlbHNlIHtcblx0XHRcdFx0YWxlcnQoJ1BsZWluIMOpY3JhbiBub24gc3VwcG9ydMOpLi4uJylcblx0XHRcdH1cblx0XHR9XG5cblx0XHQkZnVsbHNjcmVlbi5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWRvd24nLCAoKSA9PiB7XG5cdFx0XHRmdWxsc2NyZWVuKClcblx0XHR9KVxuXG5cdFx0ZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIChldmVudCkgPT4ge1xuXHRcdFx0aWYgKGV2ZW50LmtleUNvZGUgPT0gNzApIHtcblx0XHRcdFx0ZnVsbHNjcmVlbigpXG5cdFx0XHR9XG5cdFx0fSlcblx0fVxufSIsImNsYXNzIFBsYXlsaXN0IHtcblxuXHRpbml0KCRfaW1wb3J0KSB7XG5cdFx0dGhpcy5saXN0ID0gW11cblx0XHR0aGlzLiR0ZW1wID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnRlbXAnKVxuXHRcdHRoaXMuJG1lZGlhTmFtZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5tZWRpYS1uYW1lJylcblxuXHRcdGNvbnN0ICRpbXBvcnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCRfaW1wb3J0KVxuXHRcdCRpbXBvcnQuYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgKCkgPT4ge1xuXHRcdFx0cGxheWxpc3QuYWRkKCRpbXBvcnQpXG5cdFx0fSlcblx0fVxuXG5cdGFkZCgkaW1wb3J0KSB7XG5cdFx0Y29uc3QgJHZpZGVvID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcigndmlkZW8nKVxuXHRcdGNvbnN0ICRmaWxlID0gJGltcG9ydC5maWxlc1swXVxuXHRcdGNvbnN0IHJlYWRlciA9IG5ldyBGaWxlUmVhZGVyKClcblxuXHRcdHJlYWRlci5hZGRFdmVudExpc3RlbmVyKCdsb2FkJywgKCkgPT4ge1xuXHRcdFx0dGhpcy4kbWVkaWFOYW1lLmlubmVySFRNTCBcblxuXHRcdFx0Y29uc3QgY2xlYW5OYW1lID0gKHVybCkgPT4ge1xuXHRcdFx0XHR1cmwgPSB1cmwuc3BsaXQoJ1xcXFwnKVsyXS5zcGxpdCgnLicpWzBdXG5cdFx0XHRcdHVybCA9IHVybC5yZXBsYWNlKCctJywgJyAnKVxuXHRcdFx0XHRyZXR1cm4gdXJsXG5cdFx0XHR9XG5cdFxuXHRcdFx0Y29uc3QgdHJhY2tOYW1lID0gY2xlYW5OYW1lKCRpbXBvcnQudmFsdWUpXG5cdFx0XHR0aGlzLiR0ZW1wLnNyYyA9IHJlYWRlci5yZXN1bHRcblxuXHRcdFx0dGhpcy5saXN0LnB1c2goW3JlYWRlci5yZXN1bHQsIHRyYWNrTmFtZV0pXG5cdFx0XHRwbGF5bGlzdC51cGRhdGVMaXN0KHRoaXMubGlzdClcblxuXHRcdH0sIGZhbHNlKVxuXG5cdFx0aWYgKCRmaWxlKSB7XG5cdFx0XHRyZWFkZXIucmVhZEFzRGF0YVVSTCgkZmlsZSlcblx0XHR9XG5cdH1cblxuXHR1cGRhdGVMaXN0KHRyYWNrcykge1xuXHRcdGNvbnN0ICR0cmFja3MgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcudHJhY2tzJylcblxuXHRcdCR0cmFja3MuaW5uZXJIVE1MID0gJydcblx0XHRcblx0XHRmb3IgKGNvbnN0IHRyYWNrIG9mIHRyYWNrcykge1xuXHRcdFx0Y29uc3QgdHJhY2tVUkwgPSB0cmFja1swXVxuXHRcdFx0Y29uc3QgdHJhY2tOYW1lID0gdHJhY2tbMV1cblxuXHRcdFx0Y29uc3QgJHRyYWNrID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jylcblx0XHRcdCR0cmFjay5jbGFzc0xpc3QuYWRkKCd0cmFjaycpXG5cdFx0XHQkdHJhY2tzLmFwcGVuZENoaWxkKCR0cmFjaylcblxuXHRcdFx0Y29uc3QgJHRyYWNrTmFtZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpXG5cdFx0XHQkdHJhY2tOYW1lLmNsYXNzTGlzdC5hZGQoJ3RyYWNrLW5hbWUnKVxuXHRcdFx0JHRyYWNrTmFtZS5pbm5lckhUTUwgPSB0cmFja05hbWVcblx0XHRcdCR0cmFjay5hcHBlbmRDaGlsZCgkdHJhY2tOYW1lKVxuXG5cdFx0XHRjb25zdCAkc2tpcCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2J1dHRvbicpXG5cdFx0XHQkc2tpcC5jbGFzc0xpc3QuYWRkKCdza2lwJylcblx0XHRcdCRza2lwLmlubmVySFRNTCA9ICc8aSBjbGFzcz1cImZhIGZhLXBsYXlcIiBhcmlhLWhpZGRlbj1cInRydWVcIj48L2k+J1xuXHRcdFx0JHRyYWNrLmFwcGVuZENoaWxkKCRza2lwKVxuXG5cdFx0XHRwbGF5bGlzdC5za2lwKClcblx0XHR9XG5cdH1cblxuXHRuZXh0KCkge1xuXHRcdGlmICh0aGlzLmxpc3RbMF0pIHtcblx0XHRcdGNvbnN0IHRyYWNrVVJMID0gdGhpcy5saXN0WzBdWzBdXG5cdFx0XHRjb25zdCB0cmFja05hbWUgPSB0aGlzLmxpc3RbMF1bMV1cblx0XHRcdHRoaXMubGlzdC5zcGxpY2UoMCwgMSlcblx0XHRcdHBsYXlsaXN0LnVwZGF0ZUxpc3QodGhpcy5saXN0KVxuXHRcdFx0dGhpcy4kbWVkaWFOYW1lLmlubmVySFRNTCA9IHRyYWNrTmFtZVxuXHRcdFx0cGxheWVyLmluaXQoJy5wbGF5ZXInLCAndmlkZW8nLCB0cmFja1VSTClcblx0XHRcdHBsYXllci5wbGF5UGF1c2UoJy5wbGF5LXBhdXNlJylcblx0XHR9XG5cdH1cblxuXHRza2lwKCkge1xuXHRcdGNvbnN0ICRza2lwcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5za2lwJylcblxuXHRcdGZvciAobGV0IHNraXAgPSAwOyBza2lwIDwgJHNraXBzLmxlbmd0aDsgc2tpcCsrKSB7XG5cdFx0XHQkc2tpcHNbc2tpcF0uYWRkRXZlbnRMaXN0ZW5lcignbW91c2Vkb3duJywgKCkgPT4ge1xuXHRcdFx0XHRwbGF5ZXIuaW5pdCgnLnBsYXllcicsICcubWVkaWEnLCB0aGlzLmxpc3Rbc2tpcF1bMF0pXG5cdFx0XHRcdHRoaXMubGlzdC5zcGxpY2Uoc2tpcCwgMSlcblx0XHRcdFx0dXBkYXRlTGlzdCh0aGlzLmxpc3QpXG5cdFx0XHR9KVxuXHRcdH1cblx0fVxufVxuIiwiLyogZ2xvYmFsIFBsYXllciAqL1xuXG5jb25zdCBwbGF5ZXIgPSBuZXcgUGxheWVyKClcbmNvbnN0IHBsYXlsaXN0ID0gbmV3IFBsYXlsaXN0KClcblxubGV0IHRyYWNrVVJMID0gJ2Fzc2V0cy9tZWRpYS9jYWJpYWMubXA0J1xuXG5wbGF5ZXIuaW5pdCgnLnBsYXllcicsICcubWVkaWEnLCB0cmFja1VSTClcblxuLy8gUExBWUVSIEZFQVRVUkVTIFxucGxheWVyLmNvbnRyb2xzKCcuY29udHJvbHMnKVxucGxheWVyLnBsYXlQYXVzZSgnLnBsYXktcGF1c2UnKVxucGxheWVyLnRpbWUoJy5jdXJyZW50LXRpbWUnLCAnLnRvdGFsLXRpbWUnLCAnLnRpbWUtYmFyJylcbnBsYXllci52b2x1bWUoJy52b2x1bWUtaWNvbicsICcudm9sdW1lLWJhcicpXG5wbGF5ZXIuZnVsbHNjcmVlbignLmZ1bGxzY3JlZW4nKVxuXG5cbnBsYXlsaXN0LmluaXQoJy5pbXBvcnQnKSJdfQ==
